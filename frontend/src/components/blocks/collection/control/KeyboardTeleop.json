{"editor":{"id":"9535590f-f872-4d56-93e5-801e7ad78995","locked":false,"offsetX":0,"offsetY":0,"zoom":100,"gridSize":0,"layers":[{"id":"8446d7dd-0cfb-4c1f-91e5-a10123c73b16","type":"diagram-links","isSvg":true,"transformed":true,"models":{"b05238e5-8cae-45ab-b608-124d82bd10d5":{"id":"b05238e5-8cae-45ab-b608-124d82bd10d5","type":"default","selected":false,"source":"0001-be8f7992-cf26-4c50-b321-e183512eebb8","sourcePort":"459cf253-db59-40e3-bcc9-822ba359df54","target":"64616fab-7431-431c-8d64-93db30474630","targetPort":"990bd8ec-b65e-4651-a892-10aec6fd47e4","points":[{"id":"77dfba4c-498e-49df-9aa6-1c25aa65d92d","type":"point","x":386,"y":135.5},{"id":"27d7abfe-f99b-47ca-b26b-6dd7eb3818c1","type":"point","x":383.390625,"y":208.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"057aa458-342e-4493-94f6-b65a550aa06a":{"id":"057aa458-342e-4493-94f6-b65a550aa06a","type":"default","selected":false,"source":"0005-5ef554bf-2a47-4d0c-a608-c2c60cd2dbb3","sourcePort":"91c20825-8e4a-4a59-baf7-c7caad6387a0","target":"64616fab-7431-431c-8d64-93db30474630","targetPort":"475a13c2-0c09-4633-becf-07379c17c4d6","points":[{"id":"f69ad2a4-b05a-482a-8173-a717a8a7d3fd","type":"point","x":568,"y":140.5},{"id":"04e8f4b6-dc05-463b-a3a7-b691245576c7","type":"point","x":559.09375,"y":208.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"2cc53694-72f9-401f-a279-3483d9b0eeb7":{"id":"2cc53694-72f9-401f-a279-3483d9b0eeb7","type":"default","selected":false,"source":"0006-9302bb92-69cd-42e7-aa13-be4f9e1c8e83","sourcePort":"82ff745c-590b-4d31-afa9-ed90317c8234","target":"64616fab-7431-431c-8d64-93db30474630","targetPort":"50d5b2f7-3a8a-4ee1-a4db-591ac05010dd","points":[{"id":"ecd02549-4a94-457c-8dea-cbfe1b88173c","type":"point","x":743,"y":138.5},{"id":"4f98636c-60e8-462e-8f12-4c5fc7cfc9fe","type":"point","x":737.375,"y":208.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"9b13fca0-1c52-4133-b2a7-0b154d0d94a5":{"id":"9b13fca0-1c52-4133-b2a7-0b154d0d94a5","type":"default","selected":false,"source":"0007-90ebfe14-c4b9-4ec4-8b48-ea9064746612","sourcePort":"f6f7bcd5-fb62-44e2-9b59-e83a7704a321","target":"64616fab-7431-431c-8d64-93db30474630","targetPort":"cb876d0e-eacd-4939-b9ac-5cfce9808ae7","points":[{"id":"503abb87-435f-403f-b6fa-d26135e7c04f","type":"point","x":916,"y":138.5},{"id":"f3bc7977-45ff-40d5-916f-32459f9b10c6","type":"point","x":919.125,"y":208.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"5a3a1489-3bd8-4581-8552-27bed78fba8a":{"id":"5a3a1489-3bd8-4581-8552-27bed78fba8a","type":"default","selected":false,"source":"0008-93b9c4ba-c7a7-4353-b9c8-25bd79bf25a8","sourcePort":"fe7daa66-2cb9-4da4-9fa9-5bcf985de422","target":"64616fab-7431-431c-8d64-93db30474630","targetPort":"02fc6183-aed0-47f7-b0c4-36143467cbf3","points":[{"id":"07ebe855-6707-4e7d-bce8-17580850300b","type":"point","x":1102,"y":142.5},{"id":"17b9136c-69c6-455c-8967-b8ea3ac74c73","type":"point","x":1104.375,"y":208.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"7cd278a9-39ba-4055-ab8f-73cec096e2f0":{"id":"7cd278a9-39ba-4055-ab8f-73cec096e2f0","type":"default","selected":false,"source":"183c60a7-af84-4ddf-985a-bfc2f81124cd","sourcePort":"b49bbd0f-96c1-4ba0-a8d4-00c0b91a2515","target":"64616fab-7431-431c-8d64-93db30474630","targetPort":"e7c58e31-06f8-4602-be25-efa3e03d3a50","points":[{"id":"c329fffc-21da-425c-8f88-925bd84d8df7","type":"point","x":158.5,"y":410.5},{"id":"1801e07d-0ebe-4d1c-b031-e266a76deb7b","type":"point","x":239.5,"y":428.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"34cb4fb5-a6e4-460c-9774-170747c07a37":{"id":"34cb4fb5-a6e4-460c-9774-170747c07a37","type":"default","selected":false,"source":"64616fab-7431-431c-8d64-93db30474630","sourcePort":"f06d139d-a187-4549-ad2d-69d6de50ee7b","target":"2d2c817e-6101-40a7-ad75-c82e1969bd77","targetPort":"1ab136b5-43c6-42be-85d8-a4292176b1a7","points":[{"id":"dc346f45-c09c-4773-a038-cb75f0fe49be","type":"point","x":1254.375,"y":428.5},{"id":"24a6a698-0891-49df-a30b-8b80c9ab1554","type":"point","x":1336.5,"y":421.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"}}},{"id":"001e20f3-cd90-4b7c-8d26-812e2a00956d","type":"diagram-nodes","isSvg":false,"transformed":true,"models":{"0001-be8f7992-cf26-4c50-b321-e183512eebb8":{"id":"0001-be8f7992-cf26-4c50-b321-e183512eebb8","type":"basic.constant","selected":false,"x":325,"y":20,"ports":[{"id":"459cf253-db59-40e3-bcc9-822ba359df54","type":"port.output","x":378.5,"y":128,"name":"constant-out","alignment":"bottom","parentNode":"0001-be8f7992-cf26-4c50-b321-e183512eebb8","links":["b05238e5-8cae-45ab-b608-124d82bd10d5"],"in":false,"label":"constant-out","hideLabel":true}],"data":{"name":"Frequency","value":"30.0","local":true}},"0005-5ef554bf-2a47-4d0c-a608-c2c60cd2dbb3":{"id":"0005-5ef554bf-2a47-4d0c-a608-c2c60cd2dbb3","type":"basic.constant","selected":false,"x":507,"y":25,"ports":[{"id":"91c20825-8e4a-4a59-baf7-c7caad6387a0","type":"port.output","x":560.5,"y":133,"name":"constant-out","alignment":"bottom","parentNode":"0005-5ef554bf-2a47-4d0c-a608-c2c60cd2dbb3","links":["057aa458-342e-4493-94f6-b65a550aa06a"],"in":false,"label":"constant-out","hideLabel":true}],"data":{"name":"Min Linear","value":"0.26","local":true}},"0006-9302bb92-69cd-42e7-aa13-be4f9e1c8e83":{"id":"0006-9302bb92-69cd-42e7-aa13-be4f9e1c8e83","type":"basic.constant","selected":false,"x":682,"y":23,"ports":[{"id":"82ff745c-590b-4d31-afa9-ed90317c8234","type":"port.output","x":735.5,"y":131,"name":"constant-out","alignment":"bottom","parentNode":"0006-9302bb92-69cd-42e7-aa13-be4f9e1c8e83","links":["2cc53694-72f9-401f-a279-3483d9b0eeb7"],"in":false,"label":"constant-out","hideLabel":true}],"data":{"name":"Max Linear","value":"10","local":true}},"0007-90ebfe14-c4b9-4ec4-8b48-ea9064746612":{"id":"0007-90ebfe14-c4b9-4ec4-8b48-ea9064746612","type":"basic.constant","selected":false,"x":855,"y":23,"ports":[{"id":"f6f7bcd5-fb62-44e2-9b59-e83a7704a321","type":"port.output","x":908.5,"y":131,"name":"constant-out","alignment":"bottom","parentNode":"0007-90ebfe14-c4b9-4ec4-8b48-ea9064746612","links":["9b13fca0-1c52-4133-b2a7-0b154d0d94a5"],"in":false,"label":"constant-out","hideLabel":true}],"data":{"name":"Min Angular","value":"0","local":true}},"0008-93b9c4ba-c7a7-4353-b9c8-25bd79bf25a8":{"id":"0008-93b9c4ba-c7a7-4353-b9c8-25bd79bf25a8","type":"basic.constant","selected":false,"x":1041,"y":27,"ports":[{"id":"fe7daa66-2cb9-4da4-9fa9-5bcf985de422","type":"port.output","x":1094.5,"y":135,"name":"constant-out","alignment":"bottom","parentNode":"0008-93b9c4ba-c7a7-4353-b9c8-25bd79bf25a8","links":["5a3a1489-3bd8-4581-8552-27bed78fba8a"],"in":false,"label":"constant-out","hideLabel":true}],"data":{"name":"Max Angular","value":"1.82","local":true}},"64616fab-7431-431c-8d64-93db30474630":{"id":"64616fab-7431-431c-8d64-93db30474630","type":"basic.code","selected":false,"x":231,"y":200,"ports":[{"id":"e7c58e31-06f8-4602-be25-efa3e03d3a50","type":"port.input","x":232,"y":421,"name":"E","alignment":"left","parentNode":"64616fab-7431-431c-8d64-93db30474630","links":["7cd278a9-39ba-4055-ab8f-73cec096e2f0"],"in":true,"label":"E","hideLabel":false},{"id":"f06d139d-a187-4549-ad2d-69d6de50ee7b","type":"port.output","x":1246.875,"y":421,"name":"velocity","alignment":"right","parentNode":"64616fab-7431-431c-8d64-93db30474630","links":["34cb4fb5-a6e4-460c-9774-170747c07a37"],"in":false,"label":"velocity","hideLabel":false},{"id":"990bd8ec-b65e-4651-a892-10aec6fd47e4","type":"port.parameter","x":375.890625,"y":201,"name":"Frequency","alignment":"top","parentNode":"64616fab-7431-431c-8d64-93db30474630","links":["b05238e5-8cae-45ab-b608-124d82bd10d5"],"in":true,"label":"Frequency","hideLabel":false},{"id":"475a13c2-0c09-4633-becf-07379c17c4d6","type":"port.parameter","x":551.59375,"y":201,"name":"Min_Linear","alignment":"top","parentNode":"64616fab-7431-431c-8d64-93db30474630","links":["057aa458-342e-4493-94f6-b65a550aa06a"],"in":true,"label":"Min_Linear","hideLabel":false},{"id":"50d5b2f7-3a8a-4ee1-a4db-591ac05010dd","type":"port.parameter","x":729.875,"y":201,"name":"Max_Linear","alignment":"top","parentNode":"64616fab-7431-431c-8d64-93db30474630","links":["2cc53694-72f9-401f-a279-3483d9b0eeb7"],"in":true,"label":"Max_Linear","hideLabel":false},{"id":"cb876d0e-eacd-4939-b9ac-5cfce9808ae7","type":"port.parameter","x":911.625,"y":201,"name":"Min_Angular","alignment":"top","parentNode":"64616fab-7431-431c-8d64-93db30474630","links":["9b13fca0-1c52-4133-b2a7-0b154d0d94a5"],"in":true,"label":"Min_Angular","hideLabel":false},{"id":"02fc6183-aed0-47f7-b0c4-36143467cbf3","type":"port.parameter","x":1096.875,"y":201,"name":"Max_Angular","alignment":"top","parentNode":"64616fab-7431-431c-8d64-93db30474630","links":["5a3a1489-3bd8-4581-8552-27bed78fba8a"],"in":true,"label":"Max_Angular","hideLabel":false}],"data":{"code":"\nimport threading\nimport sys, select, os\nfrom time import sleep\nimport numpy as np\nfrom utils.wires.wire_str import read_string, share_string\nfrom utils.tools.freq_monitor import monitor_frequency\n\n\nfrom PyQt5.QtWidgets import QApplication, QWidget, QDesktopWidget\nfrom PyQt5.QtWidgets import (QComboBox, QFileDialog, QFormLayout, QFrame,\n                             QGridLayout, QGroupBox, QHBoxLayout, QLabel,\n                             QLineEdit, QMainWindow, QProgressBar, QPushButton,\n                             QSpinBox, QSystemTrayIcon, QTextEdit, QToolButton,\n                             QVBoxLayout, QWidget)\n\n\n\n\n\nBURGER_MAX_LIN_VEL = 0.22\nBURGER_MAX_ANG_VEL = 2.84\n\nWAFFLE_MAX_LIN_VEL = 0.26\nWAFFLE_MAX_ANG_VEL = 1.82\n\n\nLIN_VEL_STEP_SIZE = 0.01\nANG_VEL_STEP_SIZE = 0.1\n\nmsg = \"\"\"\nControl Your TurtleBot3!\n---------------------------\nMoving around:\n        w\n   a    s    d\n        x\n\nw/x : increase/decrease linear velocity (Burger : ~ 0.22, Waffle and Waffle Pi : ~ 0.26)\na/d : increase/decrease angular velocity (Burger : ~ 2.84, Waffle and Waffle Pi : ~ 1.82)\n\nspace key, s : force stop\n\nCTRL-C to quit\n\"\"\"\n\ne = \"\"\"\nCommunications Failed\n\"\"\"\n\n\n\ndef constrain(input, low, high):\n    if input < low:\n      input = low\n    elif input > high:\n      input = high\n    else:\n      input = input\n\n    return input\n\ndef vels(target_linear_vel, target_angular_vel):\n    return \"currently:\\tlinear vel %s\\t angular vel %s \" % (target_linear_vel,target_angular_vel)\n\ndef loop(block_name, input_wires, output_wires, parameters, flags):\n\n    output_0 = share_string(output_wires[0])\n    enabled = False\n    try:\n        enable_wire = read_string(input_wires[0])\n    except IndexError:\n        enabled = True\n\n    required_frequency, update = float(parameters[0]), 1\n    control_data = np.array([0.0,0.03])\n\n    if flags[0] == 1:\n        monitor_frequency(block_name, control_data, required_frequency, update)\n\n\n    MIN_LIN_VEL = float(parameters[1])\n    MAX_LIN_VEL = float(parameters[2])\n    MIN_ANG_VEL = float(parameters[3])\n    MAX_ANG_VEL = float(parameters[4])\n\n    try:\n\n        app = QApplication(sys.argv)\n\n        w = ArrowWindow(output_0, control_data, MIN_LIN_VEL, MAX_LIN_VEL, MIN_ANG_VEL, MAX_ANG_VEL)\n        w.resize(250, 150)\n        w.show()\n        sys.exit(app.exec_())\n\n    except KeyboardInterrupt:\n        # enable_wire.release()\n        output_0.release()\n        app.quit()\n\n\n\nclass ArrowWindow(QWidget):\n\n    def __init__(self, output, control_data, MIN_LIN_VEL, MAX_LIN_VEL, MIN_ANG_VEL, MAX_ANG_VEL):\n        super().__init__()\n        self.output = output\n        self.control_data = control_data\n        self.MIN_LIN_VEL = MIN_LIN_VEL\n        self.MAX_LIN_VEL = MAX_LIN_VEL\n        self.MIN_ANG_VEL = MIN_ANG_VEL\n        self.MAX_ANG_VEL = MAX_ANG_VEL\n        self.linear_vel = 0\n        self.angular_vel = 0\n        self.initUI()\n\n    def initUI(self):\n\n        self.resize(250, 250)\n        self.center()\n\n        self.setWindowTitle('Controller')\n        self.show()\n        self.grid = self.grid = QGridLayout()\n\n        stop_button = QPushButton('⏹', self)\n        stop_button.clicked.connect(self.stop_pressed)\n        up_button = QPushButton('▲', self)\n        up_button.clicked.connect(self.up_pressed)\n        left_button = QPushButton('◄', self)\n        left_button.clicked.connect(self.left_pressed)\n        right_button = QPushButton('►', self)\n        right_button.clicked.connect(self.right_pressed)\n        down_button = QPushButton('▼', self)\n        down_button.clicked.connect(self.down_pressed)\n\n        self.grid.addWidget(up_button, 1, 2, 1, 1)\n        self.grid.addWidget(left_button, 2, 1, 1, 1)\n        self.grid.addWidget(right_button, 2, 3, 1, 1)\n        self.grid.addWidget(down_button, 3, 2, 1, 1)\n        self.grid.addWidget(stop_button, 2, 2, 1, 1)\n\n        self.setLayout(self.grid)\n\n\n    def stop_pressed(self):\n        self.linear_vel = 0\n        self.angular_vel = 0\n        self.send_data()\n\n    def up_pressed(self):\n        self.linear_vel = constrain(self.linear_vel + LIN_VEL_STEP_SIZE, \n                        self.MIN_LIN_VEL, self.MAX_LIN_VEL)\n        self.send_data()\n\n    def left_pressed(self):\n        self.angular_vel = constrain(self.angular_vel + ANG_VEL_STEP_SIZE,\n                        self.MIN_ANG_VEL, self.MAX_ANG_VEL)\n        self.send_data()\n\n    def right_pressed(self):\n        self.angular_vel = constrain(self.angular_vel - ANG_VEL_STEP_SIZE,\n                        self.MIN_ANG_VEL, self.MAX_ANG_VEL)\n        self.send_data()\n\n    def down_pressed(self):\n        self.linear_vel = constrain(self.linear_vel - LIN_VEL_STEP_SIZE,\n                        self.MIN_LIN_VEL, self.MAX_LIN_VEL)\n        self.send_data()\n\n\n    def send_data(self):\n        print('Sending data', self.linear_vel, self.angular_vel)\n        data = []\n        data.extend((str(self.linear_vel), str(self.angular_vel)))\n        to_write = np.array(data, dtype='<U64')\n        self.output.add(to_write)\n        self.control_data[0] += 1\n\n\n    def center(self):\n\n        qr = self.frameGeometry()\n        cp = QDesktopWidget().availableGeometry().center()\n        qr.moveCenter(cp)\n        self.move(qr.topLeft())","params":[{"name":"Frequency"},{"name":"Min_Linear"},{"name":"Max_Linear"},{"name":"Min_Angular"},{"name":"Max_Angular"}],"ports":{"in":[{"name":"E"}],"out":[{"name":"velocity"}]},"size":{"width":"971px","height":"404px"}}},"183c60a7-af84-4ddf-985a-bfc2f81124cd":{"id":"183c60a7-af84-4ddf-985a-bfc2f81124cd","type":"basic.input","selected":false,"x":65,"y":384,"ports":[{"id":"b49bbd0f-96c1-4ba0-a8d4-00c0b91a2515","type":"port.output","x":151,"y":403,"name":"input-out","alignment":"right","parentNode":"183c60a7-af84-4ddf-985a-bfc2f81124cd","links":["7cd278a9-39ba-4055-ab8f-73cec096e2f0"],"in":false,"label":"input-out","hideLabel":true}],"data":{"name":"E"}},"2d2c817e-6101-40a7-ad75-c82e1969bd77":{"id":"2d2c817e-6101-40a7-ad75-c82e1969bd77","type":"basic.output","selected":false,"x":1328,"y":395,"ports":[{"id":"1ab136b5-43c6-42be-85d8-a4292176b1a7","type":"port.input","x":1329,"y":414,"name":"output-in","alignment":"left","parentNode":"2d2c817e-6101-40a7-ad75-c82e1969bd77","links":["34cb4fb5-a6e4-460c-9774-170747c07a37"],"in":true,"label":"output-in","hideLabel":true}],"data":{"name":"Velocity"}}}}]},"version":"3.0","package":{"name":"TeleopKey","version":"1.0.0","description":"Teleoperator using Keyboard","author":"Suhas Gopal","image":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyIKICAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgIHhtbG5zOmNjPSJodHRwOi8vd2ViLnJlc291cmNlLm9yZy9jYy8iCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpzb2RpcG9kaT0iaHR0cDovL2lua3NjYXBlLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiCiAgICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICAgeG1sbnM6bnMxPSJodHRwOi8vc296aS5iYWllcm91Z2UuZnIiCiAgICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIKICAgIGlkPSJzdmcxNDY4IgogICAgc29kaXBvZGk6ZG9jbmFtZT0ia2V5YjEuc3ZnIgogICAgdmlld0JveD0iMCAwIDE4Ny41IDE4Ny41IgogICAgc29kaXBvZGk6dmVyc2lvbj0iMC4zMiIKICAgIHZlcnNpb249IjEuMCIKICAgIHk9IjAiCiAgICB4PSIwIgogICAgaW5rc2NhcGU6dmVyc2lvbj0iMC40MiIKICAgIHNvZGlwb2RpOmRvY2Jhc2U9IkM6XERvY3VtZW50cyBhbmQgU2V0dGluZ3NcSmFybm9cT21hdCB0aWVkb3N0b3RcdmFuaGFzdGFcb3BlbmNsaXBhcnRzXG9tYXRcc3ltYm9scyIKICA+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgICBpZD0iYmFzZSIKICAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iNjQwIgogICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgIGlua3NjYXBlOnpvb209IjEuODM0NjY2NyIKICAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJzdmcxNDY4IgogICAgICBpbmtzY2FwZTpjeD0iOTMuNzUwMDAwIgogICAgICBpbmtzY2FwZTpjeT0iOTMuNzUwMDAwIgogICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI0ODAiCiAgICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgLz4KICA8ZwogICAgICBpZD0ibGF5ZXIxIgogICAgPgogICAgPGcKICAgICAgICBpZD0iZzI3MzYiCiAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEzOC42MSAtODU3LjIzKSIKICAgICAgPgogICAgICA8cmVjdAogICAgICAgICAgaWQ9InJlY3QyNzAwIgogICAgICAgICAgc3R5bGU9InN0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2U6IzAwMDAwMDtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2Utd2lkdGg6My44NTIxO2ZpbGw6I2ZmZmZmZiIKICAgICAgICAgIHJ4PSI5LjQ2ODEiCiAgICAgICAgICByeT0iMTQuOTciCiAgICAgICAgICBoZWlnaHQ9IjU4LjQ1NSIKICAgICAgICAgIHdpZHRoPSIxMjEuODIiCiAgICAgICAgICB5PSI5MzEuOTMiCiAgICAgICAgICB4PSIxNzEuNDUiCiAgICAgIC8+CiAgICAgIDxwYXRoCiAgICAgICAgICBpZD0icGF0aDI3MDIiCiAgICAgICAgICBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLWRhc2hhcnJheTo0LjkxNzUxMjQgNC45MTc1MTI0O3N0cm9rZS13aWR0aDo0LjkxNzU7ZmlsbDpub25lIgogICAgICAgICAgZD0ibTE4NC4wNiA5NDcuMzZoOTQuMDgiCiAgICAgIC8+CiAgICAgIDxwYXRoCiAgICAgICAgICBpZD0icGF0aDI3MDQiCiAgICAgICAgICBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLWRhc2hhcnJheTo0LjkxNzUxMjQgNC45MTc1MTI0O3N0cm9rZS13aWR0aDo0LjkxNzU7ZmlsbDpub25lIgogICAgICAgICAgZD0ibTE4NC4wNiA5NTcuMDVoOTQuMDgiCiAgICAgIC8+CiAgICAgIDxwYXRoCiAgICAgICAgICBpZD0icGF0aDI3MDYiCiAgICAgICAgICBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLWRhc2hhcnJheTo0LjkxNzUxMjQgNC45MTc1MTI0O3N0cm9rZS13aWR0aDo0LjkxNzU7ZmlsbDpub25lIgogICAgICAgICAgZD0ibTE4NC4wNiA5NjYuNzVoOTQuMDgiCiAgICAgIC8+CiAgICAgIDxwYXRoCiAgICAgICAgICBpZD0icGF0aDI3MDgiCiAgICAgICAgICBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjQuOTE3NTtmaWxsOm5vbmUiCiAgICAgICAgICBkPSJtMTg0LjA2IDk3Ny4yM2g5NC4wOCIKICAgICAgLz4KICAgICAgPHBhdGgKICAgICAgICAgIGlkPSJwYXRoMjcxMiIKICAgICAgICAgIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2Utd2lkdGg6NC4zOTg2O2ZpbGw6bm9uZSIKICAgICAgICAgIGQ9Im0yNzguNjcgOTI5Ljg0czguODYtMTMuOTgtMC4zMS0yMS40N2MtMTAuNzYtOC43OS0yMC44MSA4LjY2LTM2LjU1LTMuMDciCiAgICAgIC8+CiAgICA8L2cKICAgID4KICA8L2cKICA+CiAgPG1ldGFkYXRhCiAgICA+CiAgICA8cmRmOlJERgogICAgICA+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgPgogICAgICAgIDxkYzpmb3JtYXQKICAgICAgICAgID5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQKICAgICAgICA+CiAgICAgICAgPGRjOnR5cGUKICAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIKICAgICAgICAvPgogICAgICAgIDxjYzpsaWNlbnNlCiAgICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvcHVibGljZG9tYWluLyIKICAgICAgICAvPgogICAgICAgIDxkYzpwdWJsaXNoZXIKICAgICAgICAgID4KICAgICAgICAgIDxjYzpBZ2VudAogICAgICAgICAgICAgIHJkZjphYm91dD0iaHR0cDovL29wZW5jbGlwYXJ0Lm9yZy8iCiAgICAgICAgICAgID4KICAgICAgICAgICAgPGRjOnRpdGxlCiAgICAgICAgICAgICAgPk9wZW5jbGlwYXJ0PC9kYzp0aXRsZQogICAgICAgICAgICA+CiAgICAgICAgICA8L2NjOkFnZW50CiAgICAgICAgICA+CiAgICAgICAgPC9kYzpwdWJsaXNoZXIKICAgICAgICA+CiAgICAgICAgPGRjOnRpdGxlCiAgICAgICAgICA+S2V5Ym9hcmQgMSBpY29uPC9kYzp0aXRsZQogICAgICAgID4KICAgICAgICA8ZGM6ZGF0ZQogICAgICAgICAgPjIwMDYtMTItMjZUMDA6MDA6MDA8L2RjOmRhdGUKICAgICAgICA+CiAgICAgICAgPGRjOmRlc2NyaXB0aW9uCiAgICAgICAgLz4KICAgICAgICA8ZGM6c291cmNlCiAgICAgICAgICA+aHR0cHM6Ly9vcGVuY2xpcGFydC5vcmcvZGV0YWlsLzI0NTg0Ly1ieS0tMjQ1ODQ8L2RjOnNvdXJjZQogICAgICAgID4KICAgICAgICA8ZGM6Y3JlYXRvcgogICAgICAgICAgPgogICAgICAgICAgPGNjOkFnZW50CiAgICAgICAgICAgID4KICAgICAgICAgICAgPGRjOnRpdGxlCiAgICAgICAgICAgICAgPkFub255bW91czwvZGM6dGl0bGUKICAgICAgICAgICAgPgogICAgICAgICAgPC9jYzpBZ2VudAogICAgICAgICAgPgogICAgICAgIDwvZGM6Y3JlYXRvcgogICAgICAgID4KICAgICAgPC9jYzpXb3JrCiAgICAgID4KICAgICAgPGNjOkxpY2Vuc2UKICAgICAgICAgIHJkZjphYm91dD0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvcHVibGljZG9tYWluLyIKICAgICAgICA+CiAgICAgICAgPGNjOnBlcm1pdHMKICAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyNSZXByb2R1Y3Rpb24iCiAgICAgICAgLz4KICAgICAgICA8Y2M6cGVybWl0cwogICAgICAgICAgICByZGY6cmVzb3VyY2U9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zI0Rpc3RyaWJ1dGlvbiIKICAgICAgICAvPgogICAgICAgIDxjYzpwZXJtaXRzCiAgICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjRGVyaXZhdGl2ZVdvcmtzIgogICAgICAgIC8+CiAgICAgIDwvY2M6TGljZW5zZQogICAgICA+CiAgICA8L3JkZjpSREYKICAgID4KICA8L21ldGFkYXRhCiAgPgo8L3N2Zwo+Cg=="},"design":{"board":"Python3-Noetic","graph":{"blocks":[{"id":"0001-be8f7992-cf26-4c50-b321-e183512eebb8","type":"basic.constant","data":{"name":"Frequency","value":"30.0","local":true},"position":{"x":325,"y":20}},{"id":"0005-5ef554bf-2a47-4d0c-a608-c2c60cd2dbb3","type":"basic.constant","data":{"name":"Min Linear","value":"0.26","local":true},"position":{"x":507,"y":25}},{"id":"0006-9302bb92-69cd-42e7-aa13-be4f9e1c8e83","type":"basic.constant","data":{"name":"Max Linear","value":"10","local":true},"position":{"x":682,"y":23}},{"id":"0007-90ebfe14-c4b9-4ec4-8b48-ea9064746612","type":"basic.constant","data":{"name":"Min Angular","value":"0","local":true},"position":{"x":855,"y":23}},{"id":"0008-93b9c4ba-c7a7-4353-b9c8-25bd79bf25a8","type":"basic.constant","data":{"name":"Max Angular","value":"1.82","local":true},"position":{"x":1041,"y":27}},{"id":"64616fab-7431-431c-8d64-93db30474630","type":"basic.code","data":{"code":"\nimport threading\nimport sys, select, os\nfrom time import sleep\nimport numpy as np\nfrom utils.wires.wire_str import read_string, share_string\nfrom utils.tools.freq_monitor import monitor_frequency\n\n\nfrom PyQt5.QtWidgets import QApplication, QWidget, QDesktopWidget\nfrom PyQt5.QtWidgets import (QComboBox, QFileDialog, QFormLayout, QFrame,\n                             QGridLayout, QGroupBox, QHBoxLayout, QLabel,\n                             QLineEdit, QMainWindow, QProgressBar, QPushButton,\n                             QSpinBox, QSystemTrayIcon, QTextEdit, QToolButton,\n                             QVBoxLayout, QWidget)\n\n\n\n\n\nBURGER_MAX_LIN_VEL = 0.22\nBURGER_MAX_ANG_VEL = 2.84\n\nWAFFLE_MAX_LIN_VEL = 0.26\nWAFFLE_MAX_ANG_VEL = 1.82\n\n\nLIN_VEL_STEP_SIZE = 0.01\nANG_VEL_STEP_SIZE = 0.1\n\nmsg = \"\"\"\nControl Your TurtleBot3!\n---------------------------\nMoving around:\n        w\n   a    s    d\n        x\n\nw/x : increase/decrease linear velocity (Burger : ~ 0.22, Waffle and Waffle Pi : ~ 0.26)\na/d : increase/decrease angular velocity (Burger : ~ 2.84, Waffle and Waffle Pi : ~ 1.82)\n\nspace key, s : force stop\n\nCTRL-C to quit\n\"\"\"\n\ne = \"\"\"\nCommunications Failed\n\"\"\"\n\n\n\ndef constrain(input, low, high):\n    if input < low:\n      input = low\n    elif input > high:\n      input = high\n    else:\n      input = input\n\n    return input\n\ndef vels(target_linear_vel, target_angular_vel):\n    return \"currently:\\tlinear vel %s\\t angular vel %s \" % (target_linear_vel,target_angular_vel)\n\ndef loop(block_name, input_wires, output_wires, parameters, flags):\n\n    output_0 = share_string(output_wires[0])\n    enabled = False\n    try:\n        enable_wire = read_string(input_wires[0])\n    except IndexError:\n        enabled = True\n\n    required_frequency, update = float(parameters[0]), 1\n    control_data = np.array([0.0,0.03])\n\n    if flags[0] == 1:\n        monitor_frequency(block_name, control_data, required_frequency, update)\n\n\n    MIN_LIN_VEL = float(parameters[1])\n    MAX_LIN_VEL = float(parameters[2])\n    MIN_ANG_VEL = float(parameters[3])\n    MAX_ANG_VEL = float(parameters[4])\n\n    try:\n\n        app = QApplication(sys.argv)\n\n        w = ArrowWindow(output_0, control_data, MIN_LIN_VEL, MAX_LIN_VEL, MIN_ANG_VEL, MAX_ANG_VEL)\n        w.resize(250, 150)\n        w.show()\n        sys.exit(app.exec_())\n\n    except KeyboardInterrupt:\n        # enable_wire.release()\n        output_0.release()\n        app.quit()\n\n\n\nclass ArrowWindow(QWidget):\n\n    def __init__(self, output, control_data, MIN_LIN_VEL, MAX_LIN_VEL, MIN_ANG_VEL, MAX_ANG_VEL):\n        super().__init__()\n        self.output = output\n        self.control_data = control_data\n        self.MIN_LIN_VEL = MIN_LIN_VEL\n        self.MAX_LIN_VEL = MAX_LIN_VEL\n        self.MIN_ANG_VEL = MIN_ANG_VEL\n        self.MAX_ANG_VEL = MAX_ANG_VEL\n        self.linear_vel = 0\n        self.angular_vel = 0\n        self.initUI()\n\n    def initUI(self):\n\n        self.resize(250, 250)\n        self.center()\n\n        self.setWindowTitle('Controller')\n        self.show()\n        self.grid = self.grid = QGridLayout()\n\n        stop_button = QPushButton('⏹', self)\n        stop_button.clicked.connect(self.stop_pressed)\n        up_button = QPushButton('▲', self)\n        up_button.clicked.connect(self.up_pressed)\n        left_button = QPushButton('◄', self)\n        left_button.clicked.connect(self.left_pressed)\n        right_button = QPushButton('►', self)\n        right_button.clicked.connect(self.right_pressed)\n        down_button = QPushButton('▼', self)\n        down_button.clicked.connect(self.down_pressed)\n\n        self.grid.addWidget(up_button, 1, 2, 1, 1)\n        self.grid.addWidget(left_button, 2, 1, 1, 1)\n        self.grid.addWidget(right_button, 2, 3, 1, 1)\n        self.grid.addWidget(down_button, 3, 2, 1, 1)\n        self.grid.addWidget(stop_button, 2, 2, 1, 1)\n\n        self.setLayout(self.grid)\n\n\n    def stop_pressed(self):\n        self.linear_vel = 0\n        self.angular_vel = 0\n        self.send_data()\n\n    def up_pressed(self):\n        self.linear_vel = constrain(self.linear_vel + LIN_VEL_STEP_SIZE, \n                        self.MIN_LIN_VEL, self.MAX_LIN_VEL)\n        self.send_data()\n\n    def left_pressed(self):\n        self.angular_vel = constrain(self.angular_vel + ANG_VEL_STEP_SIZE,\n                        self.MIN_ANG_VEL, self.MAX_ANG_VEL)\n        self.send_data()\n\n    def right_pressed(self):\n        self.angular_vel = constrain(self.angular_vel - ANG_VEL_STEP_SIZE,\n                        self.MIN_ANG_VEL, self.MAX_ANG_VEL)\n        self.send_data()\n\n    def down_pressed(self):\n        self.linear_vel = constrain(self.linear_vel - LIN_VEL_STEP_SIZE,\n                        self.MIN_LIN_VEL, self.MAX_LIN_VEL)\n        self.send_data()\n\n\n    def send_data(self):\n        print('Sending data', self.linear_vel, self.angular_vel)\n        data = []\n        data.extend((str(self.linear_vel), str(self.angular_vel)))\n        to_write = np.array(data, dtype='<U64')\n        self.output.add(to_write)\n        self.control_data[0] += 1\n\n\n    def center(self):\n\n        qr = self.frameGeometry()\n        cp = QDesktopWidget().availableGeometry().center()\n        qr.moveCenter(cp)\n        self.move(qr.topLeft())","params":[{"name":"Frequency"},{"name":"Min_Linear"},{"name":"Max_Linear"},{"name":"Min_Angular"},{"name":"Max_Angular"}],"ports":{"in":[{"name":"E"}],"out":[{"name":"velocity"}]},"size":{"width":"971px","height":"404px"}},"position":{"x":231,"y":200}},{"id":"183c60a7-af84-4ddf-985a-bfc2f81124cd","type":"basic.input","data":{"name":"E"},"position":{"x":65,"y":384}},{"id":"2d2c817e-6101-40a7-ad75-c82e1969bd77","type":"basic.output","data":{"name":"Velocity"},"position":{"x":1328,"y":395}}],"wires":[{"source":{"block":"0001-be8f7992-cf26-4c50-b321-e183512eebb8","port":"constant-out"},"target":{"block":"64616fab-7431-431c-8d64-93db30474630","port":"Frequency"}},{"source":{"block":"0005-5ef554bf-2a47-4d0c-a608-c2c60cd2dbb3","port":"constant-out"},"target":{"block":"64616fab-7431-431c-8d64-93db30474630","port":"Min_Linear"}},{"source":{"block":"0006-9302bb92-69cd-42e7-aa13-be4f9e1c8e83","port":"constant-out"},"target":{"block":"64616fab-7431-431c-8d64-93db30474630","port":"Max_Linear"}},{"source":{"block":"0007-90ebfe14-c4b9-4ec4-8b48-ea9064746612","port":"constant-out"},"target":{"block":"64616fab-7431-431c-8d64-93db30474630","port":"Min_Angular"}},{"source":{"block":"0008-93b9c4ba-c7a7-4353-b9c8-25bd79bf25a8","port":"constant-out"},"target":{"block":"64616fab-7431-431c-8d64-93db30474630","port":"Max_Angular"}},{"source":{"block":"183c60a7-af84-4ddf-985a-bfc2f81124cd","port":"input-out"},"target":{"block":"64616fab-7431-431c-8d64-93db30474630","port":"E"}},{"source":{"block":"64616fab-7431-431c-8d64-93db30474630","port":"velocity"},"target":{"block":"2d2c817e-6101-40a7-ad75-c82e1969bd77","port":"output-in"}}]}},"dependencies":{}}